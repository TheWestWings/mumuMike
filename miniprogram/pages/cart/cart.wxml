<!-- pages/cart/cart.wxml - è´­ç‰©è½¦é¡µé¢ -->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-left" bindtap="goBack">
      <text class="back-icon">â†</text>
    </view>
    <text class="header-title">è´­ç‰©è½¦</text>
    <view class="header-right" bindtap="clearCart" wx:if="{{cartList.length > 0}}">
      <text class="clear-text">æ¸…ç©º</text>
    </view>
  </view>

  <!-- æ¡Œå·ä¿¡æ¯ -->
  <view class="table-info" wx:if="{{tableNo}}">
    <text class="table-label">ç”¨é¤æ¡Œå·</text>
    <text class="table-no">{{tableNo}} å·æ¡Œ</text>
  </view>

  <!-- è´­ç‰©è½¦åˆ—è¡¨ -->
  <scroll-view class="cart-list" scroll-y wx:if="{{cartList.length > 0}}">
    <view class="cart-item" wx:for="{{cartList}}" wx:key="index">
      <image class="item-image" src="{{item.pictureUrl}}" mode="aspectFill"></image>
      <view class="item-info">
        <text class="item-name">{{item.name}}</text>
        <text class="item-remark" wx:if="{{item.comment}}">å¤‡æ³¨: {{item.comment}}</text>
        <view class="item-bottom">
          <text class="item-price">Â¥{{item.price}}</text>
          <view class="item-actions">
            <view class="action-btn minus" data-index="{{index}}" catchtap="decreaseItem">
              <text>-</text>
            </view>
            <text class="item-count">{{item.count}}</text>
            <view class="action-btn plus" data-index="{{index}}" catchtap="increaseItem">
              <text>+</text>
            </view>
          </view>
        </view>
      </view>
      <!-- å¤‡æ³¨æŒ‰é’® -->
      <view class="remark-btn" data-index="{{index}}" catchtap="editRemark">
        <text>ğŸ“</text>
      </view>
    </view>
    <view class="bottom-space"></view>
  </scroll-view>

  <!-- ç©ºè´­ç‰©è½¦ -->
  <view class="empty-cart" wx:else>
    <text class="empty-icon">ğŸ›’</text>
    <text class="empty-text">è´­ç‰©è½¦æ˜¯ç©ºçš„</text>
    <text class="empty-hint">å¿«å»é€‰è´­ç¾å‘³å§~</text>
    <button class="go-order-btn" bindtap="goToMenu">å»ç‚¹é¤</button>
  </view>

  <!-- åº•éƒ¨ç»“ç®—æ  -->
  <view class="checkout-bar" wx:if="{{cartList.length > 0}}">
    <view class="checkout-info">
      <view class="total-row">
        <text class="total-label">åˆè®¡ï¼š</text>
        <text class="total-price">Â¥{{cartTotal}}</text>
      </view>
      <text class="total-count">å…± {{cartCount}} ä»¶å•†å“</text>
    </view>
    <button class="submit-btn" bindtap="submitOrder" loading="{{submitting}}">
      æäº¤è®¢å•
    </button>
  </view>
</view>

<!-- å¤‡æ³¨ç¼–è¾‘å¼¹çª— -->
<view class="remark-modal" wx:if="{{showRemarkModal}}">
  <view class="modal-mask" bindtap="closeRemarkModal"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">ç¼–è¾‘å¤‡æ³¨</text>
      <view class="modal-close" bindtap="closeRemarkModal">Ã—</view>
    </view>
    <view class="modal-body">
      <textarea 
        class="remark-textarea" 
        placeholder="è¯·è¾“å…¥ç‰¹æ®Šè¦æ±‚ï¼Œå¦‚ï¼šå°‘ç³–ã€å»å†°ç­‰"
        value="{{editingRemark}}"
        bindinput="onRemarkInput"
        maxlength="100"
      ></textarea>
    </view>
    <view class="modal-footer">
      <button class="modal-btn cancel" bindtap="closeRemarkModal">å–æ¶ˆ</button>
      <button class="modal-btn confirm" bindtap="saveRemark">ç¡®å®š</button>
    </view>
  </view>
</view>
